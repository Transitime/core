<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_25) on Fri Mar 28 14:48:04 PDT 2014 -->
<title>DataDbLogger</title>
<meta name="date" content="2014-03-28">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="DataDbLogger";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/DataDbLogger.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/transitime/db/hibernate/AnnotatedClassesList.html" title="class in org.transitime.db.hibernate"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/transitime/db/hibernate/HibernateUtils.html" title="class in org.transitime.db.hibernate"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/transitime/db/hibernate/DataDbLogger.html" target="_top">Frames</a></li>
<li><a href="DataDbLogger.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.transitime.db.hibernate</div>
<h2 title="Class DataDbLogger" class="title">Class DataDbLogger</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.transitime.db.hibernate.DataDbLogger</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">DataDbLogger</span>
extends java.lang.Object</pre>
<div class="block">DataDbLogger is for storing to the db a stream of data objects. It is intended
 for example for storing AVL reports, vehicle matches, arrivals, departures, etc.
 There can be quite a large volume of this type of data.
 
 The database might not always be available. It could be vacuumed, restarted, 
 moved, etc. When this happens don't want the data to be lost and don't want
 to tie up the core predictor. Therefore a queue is used to log objects.
 This makes the application far more robust with respect to database issues.
 The application simply calls add(Object o) to add the object to be stored
 to the queue. 
 
 A separate thread is used to read from the queue and write the data to the 
 database. If the queue starts filling up then error messages are e-mailed
 to users alerting them that there is a problem. E-mail messages are also
 sent out when the queue level is going down again.
 
 A goal with this class was to make the writing to the database is 
 efficient as possible. Therefore the objects are written in batches.
 This reduces network traffic as well as database load. But this did
 make handling exceptions more complicated. If there is an exception
 with a batch then each item is individually written so that don't
 lose any data.
 
 When in playback mode then don't want to store the data because it would
 interfere with data stored when the application was run in real time. 
 Therefore when running in playback mode set doNotStoreToDb to true
 when calling getDataDbLogger().</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>SkiBu Smith</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/transitime/db/hibernate/DataDbLogger.html#add(java.lang.Object)">add</a></strong>(java.lang.Object&nbsp;o)</code>
<div class="block">Adds an object to be saved in the database to the queue.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static <a href="../../../../org/transitime/db/hibernate/DataDbLogger.html" title="class in org.transitime.db.hibernate">DataDbLogger</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/transitime/db/hibernate/DataDbLogger.html#getDataDbLogger(java.lang.String, boolean)">getDataDbLogger</a></strong>(java.lang.String&nbsp;projectId,
               boolean&nbsp;doNotStoreToDb)</code>
<div class="block">Factory method.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/transitime/db/hibernate/DataDbLogger.html#main(java.lang.String[])">main</a></strong>(java.lang.String[]&nbsp;args)</code>
<div class="block">Just for doing some testing</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>double</code></td>
<td class="colLast"><code><strong><a href="../../../../org/transitime/db/hibernate/DataDbLogger.html#queueLevel()">queueLevel</a></strong>()</code>
<div class="block">Returns how much capacity of the queue is being used up.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getDataDbLogger(java.lang.String, boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDataDbLogger</h4>
<pre>public static&nbsp;<a href="../../../../org/transitime/db/hibernate/DataDbLogger.html" title="class in org.transitime.db.hibernate">DataDbLogger</a>&nbsp;getDataDbLogger(java.lang.String&nbsp;projectId,
                           boolean&nbsp;doNotStoreToDb)</pre>
<div class="block">Factory method. Returns the singleton db logger for the specified
 projectId.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>projectId</code> - Id of database to be written to</dd><dd><code>doNotStoreToDb</code> - Specifies if in playback mode and shouldn't
 write data to db.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The DataDbLogger for the specified projectId</dd></dl>
</li>
</ul>
<a name="queueLevel()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>queueLevel</h4>
<pre>public&nbsp;double&nbsp;queueLevel()</pre>
<div class="block">Returns how much capacity of the queue is being used up.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>a value between 0.0 and 1.0 indicating how much of queue being used</dd></dl>
</li>
</ul>
<a name="add(java.lang.Object)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>add</h4>
<pre>public&nbsp;boolean&nbsp;add(java.lang.Object&nbsp;o)</pre>
<div class="block">Adds an object to be saved in the database to the queue.
 If queue is getting filled up then an e-mail will be sent
 out indicating there is a problem. The queue levels at which
 an e-mail is sent out is specified by levels. If queue has
 reached capacity then an error message is logged.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>o</code> - The object that should be logged to the database</dd>
<dt><span class="strong">Returns:</span></dt><dd>True if object added to queue. False if queue was full.</dd></dl>
</li>
</ul>
<a name="main(java.lang.String[])">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>main</h4>
<pre>public static&nbsp;void&nbsp;main(java.lang.String[]&nbsp;args)</pre>
<div class="block">Just for doing some testing</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>args</code> - </dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/DataDbLogger.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/transitime/db/hibernate/AnnotatedClassesList.html" title="class in org.transitime.db.hibernate"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/transitime/db/hibernate/HibernateUtils.html" title="class in org.transitime.db.hibernate"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/transitime/db/hibernate/DataDbLogger.html" target="_top">Frames</a></li>
<li><a href="DataDbLogger.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
